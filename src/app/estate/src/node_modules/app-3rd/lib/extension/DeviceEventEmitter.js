export const DeviceEventEmitter = {
    index: 0,
    listeners: new Map(),
    addListener: (eventName, callback) => {
        DeviceEventEmitter.index++;
        let map = null;
        if (!DeviceEventEmitter.listeners.has(eventName)) {
            map = new Map();
            DeviceEventEmitter.listeners.set(eventName, map)
        } else {
            map = DeviceEventEmitter.listeners.get(eventName);
        }
        let key = `DeviceEventEmitter-${DeviceEventEmitter.index}`;
        map.set(key, callback);
        let deEmitter = {
            remove:  () => {
                map.delete(key);
            }
        }
        return deEmitter;
    },
    emit: (eventName, params) => {
        if (DeviceEventEmitter.listeners.has(eventName)) {
            let callbacks = DeviceEventEmitter.listeners.get(eventName);
            for (var callback of callbacks) {
                callback[1](params);
            }
        }
    }
};
